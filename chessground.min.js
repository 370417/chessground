!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.Chessground=e()}}(function(){return function e(t,n,r){function o(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return o(n?n:e)},c,c.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t,n){"use strict";function r(e,t,n){if(e.ns="http://www.w3.org/2000/svg","foreignObject"!==n&&void 0!==t)for(var o=0;o<t.length;++o){var i=t[o].data;void 0!==i&&r(i,t[o].children,t[o].sel)}}function o(e,t,n){var o,s,l,u={};if(void 0!==n?(u=t,a.array(n)?o=n:a.primitive(n)?s=n:n&&n.sel&&(o=[n])):void 0!==t&&(a.array(t)?o=t:a.primitive(t)?s=t:t&&t.sel?o=[t]:u=t),a.array(o))for(l=0;l<o.length;++l)a.primitive(o[l])&&(o[l]=i.vnode(void 0,void 0,void 0,o[l]));return"s"!==e[0]||"v"!==e[1]||"g"!==e[2]||3!==e.length&&"."!==e[3]&&"#"!==e[3]||r(u,o,e),i.vnode(e,u,o,s,void 0)}var i=e("./vnode"),a=e("./is");n.h=o,Object.defineProperty(n,"__esModule",{value:!0}),n.default=o},{"./is":3,"./vnode":8}],2:[function(e,t,n){"use strict";function r(e){return document.createElement(e)}function o(e,t){return document.createElementNS(e,t)}function i(e){return document.createTextNode(e)}function a(e){return document.createComment(e)}function s(e,t,n){e.insertBefore(t,n)}function l(e,t){e.removeChild(t)}function u(e,t){e.appendChild(t)}function c(e){return e.parentNode}function d(e){return e.nextSibling}function f(e){return e.tagName}function p(e,t){e.textContent=t}function v(e){return e.textContent}function m(e){return 1===e.nodeType}function h(e){return 3===e.nodeType}function b(e){return 8===e.nodeType}n.htmlDomApi={createElement:r,createElementNS:o,createTextNode:i,createComment:a,insertBefore:s,removeChild:l,appendChild:u,parentNode:c,nextSibling:d,tagName:f,setTextContent:p,getTextContent:v,isElement:m,isText:h,isComment:b},Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.htmlDomApi},{}],3:[function(e,t,n){"use strict";function r(e){return"string"==typeof e||"number"==typeof e}n.array=Array.isArray,n.primitive=r},{}],4:[function(e,t,n){"use strict";function r(e,t){var n,r,o=t.elm,i=e.data.class,a=t.data.class;if((i||a)&&i!==a){i=i||{},a=a||{};for(r in i)a[r]||o.classList.remove(r);for(r in a)n=a[r],n!==i[r]&&o.classList[n?"add":"remove"](r)}}n.classModule={create:r,update:r},Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.classModule},{}],5:[function(e,t,n){"use strict";function r(e,t,n){l(function(){e[t]=n})}function o(e,t){var n,o,i=t.elm,a=e.data.style,s=t.data.style;if((a||s)&&a!==s){a=a||{},s=s||{};var l="delayed"in a;for(o in a)s[o]||("-"===o[0]&&"-"===o[1]?i.style.removeProperty(o):i.style[o]="");for(o in s)if(n=s[o],"delayed"===o)for(o in s.delayed)n=s.delayed[o],l&&n===a.delayed[o]||r(i.style,o,n);else"remove"!==o&&n!==a[o]&&("-"===o[0]&&"-"===o[1]?i.style.setProperty(o,n):i.style[o]=n)}}function i(e){var t,n,r=e.elm,o=e.data.style;if(o&&(t=o.destroy))for(n in t)r.style[n]=t[n]}function a(e,t){var n=e.data.style;if(!n||!n.remove)return void t();var r,o,i=e.elm,a=0,s=n.remove,l=0,u=[];for(r in s)u.push(r),i.style[r]=s[r];o=getComputedStyle(i);for(var c=o["transition-property"].split(", ");a<c.length;++a)u.indexOf(c[a])!==-1&&l++;i.addEventListener("transitionend",function(e){e.target===i&&--l,0===l&&t()})}var s="undefined"!=typeof window&&window.requestAnimationFrame||setTimeout,l=function(e){s(function(){s(e)})};n.styleModule={create:o,update:o,destroy:i,remove:a},Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.styleModule},{}],6:[function(e,t,n){"use strict";function r(e){return void 0===e}function o(e){return void 0!==e}function i(e,t){return e.key===t.key&&e.sel===t.sel}function a(e){return void 0!==e.sel}function s(e,t,n){var r,o,i,a={};for(r=t;r<=n;++r)i=e[r],null!=i&&(o=i.key,void 0!==o&&(a[o]=r));return a}function l(e,t){function n(e){var t=e.id?"#"+e.id:"",n=e.className?"."+e.className.split(" ").join("."):"";return u.default(x.tagName(e).toLowerCase()+t+n,{},[],void 0,e)}function l(e,t){return function(){if(0===--t){var n=x.parentNode(e);x.removeChild(n,e)}}}function v(e,t){var n,i=e.data;void 0!==i&&o(n=i.hook)&&o(n=n.init)&&(n(e),i=e.data);var a=e.children,s=e.sel;if("!"===s)r(e.text)&&(e.text=""),e.elm=x.createComment(e.text);else if(void 0!==s){var l=s.indexOf("#"),u=s.indexOf(".",l),d=l>0?l:s.length,p=u>0?u:s.length,m=l!==-1||u!==-1?s.slice(0,Math.min(d,p)):s,h=e.elm=o(i)&&o(n=i.ns)?x.createElementNS(n,m):x.createElement(m);if(d<p&&(h.id=s.slice(d+1,p)),u>0&&(h.className=s.slice(p+1).replace(/\./g," ")),c.array(a))for(n=0;n<a.length;++n){var b=a[n];null!=b&&x.appendChild(h,v(b,t))}else c.primitive(e.text)&&x.appendChild(h,x.createTextNode(e.text));for(n=0;n<P.create.length;++n)P.create[n](f,e);n=e.data.hook,o(n)&&(n.create&&n.create(f,e),n.insert&&t.push(e))}else e.elm=x.createTextNode(e.text);return e.elm}function m(e,t,n,r,o,i){for(;r<=o;++r){var a=n[r];null!=a&&x.insertBefore(e,v(a,i),t)}}function h(e){var t,n,r=e.data;if(void 0!==r){for(o(t=r.hook)&&o(t=t.destroy)&&t(e),t=0;t<P.destroy.length;++t)P.destroy[t](e);if(void 0!==e.children)for(n=0;n<e.children.length;++n)t=e.children[n],null!=t&&"string"!=typeof t&&h(t)}}function b(e,t,n,r){for(;n<=r;++n){var i=void 0,a=void 0,s=void 0,u=t[n];if(null!=u)if(o(u.sel)){for(h(u),a=P.remove.length+1,s=l(u.elm,a),i=0;i<P.remove.length;++i)P.remove[i](u,s);o(i=u.data)&&o(i=i.hook)&&o(i=i.remove)?i(u,s):s()}else x.removeChild(e,u.elm)}}function g(e,t,n,o){for(var a,l,u,c,d=0,f=0,p=t.length-1,h=t[0],g=t[p],w=n.length-1,k=n[0],P=n[w];d<=p&&f<=w;)null==h?h=t[++d]:null==g?g=t[--p]:null==k?k=n[++f]:null==P?P=n[--w]:i(h,k)?(y(h,k,o),h=t[++d],k=n[++f]):i(g,P)?(y(g,P,o),g=t[--p],P=n[--w]):i(h,P)?(y(h,P,o),x.insertBefore(e,h.elm,x.nextSibling(g.elm)),h=t[++d],P=n[--w]):i(g,k)?(y(g,k,o),x.insertBefore(e,g.elm,h.elm),g=t[--p],k=n[++f]):(void 0===a&&(a=s(t,d,p)),l=a[k.key],r(l)?(x.insertBefore(e,v(k,o),h.elm),k=n[++f]):(u=t[l],u.sel!==k.sel?x.insertBefore(e,v(k,o),h.elm):(y(u,k,o),t[l]=void 0,x.insertBefore(e,u.elm,h.elm)),k=n[++f]));d>p?(c=null==n[w+1]?null:n[w+1].elm,m(e,c,n,f,w,o)):f>w&&b(e,t,d,p)}function y(e,t,n){var i,a;o(i=t.data)&&o(a=i.hook)&&o(i=a.prepatch)&&i(e,t);var s=t.elm=e.elm,l=e.children,u=t.children;if(e!==t){if(void 0!==t.data){for(i=0;i<P.update.length;++i)P.update[i](e,t);i=t.data.hook,o(i)&&o(i=i.update)&&i(e,t)}r(t.text)?o(l)&&o(u)?l!==u&&g(s,l,u,n):o(u)?(o(e.text)&&x.setTextContent(s,""),m(s,null,u,0,u.length-1,n)):o(l)?b(s,l,0,l.length-1):o(e.text)&&x.setTextContent(s,""):e.text!==t.text&&x.setTextContent(s,t.text),o(a)&&o(i=a.postpatch)&&i(e,t)}}var w,k,P={},x=void 0!==t?t:d.default;for(w=0;w<p.length;++w)for(P[p[w]]=[],k=0;k<e.length;++k){var C=e[k][p[w]];void 0!==C&&P[p[w]].push(C)}return function(e,t){var r,o,s,l=[];for(r=0;r<P.pre.length;++r)P.pre[r]();for(a(e)||(e=n(e)),i(e,t)?y(e,t,l):(o=e.elm,s=x.parentNode(o),v(t,l),null!==s&&(x.insertBefore(s,t.elm,x.nextSibling(o)),b(s,[e],0,0))),r=0;r<l.length;++r)l[r].data.hook.insert(l[r]);for(r=0;r<P.post.length;++r)P.post[r]();return t}}var u=e("./vnode"),c=e("./is"),d=e("./htmldomapi"),f=u.default("",{},[],void 0,void 0),p=["create","update","remove","destroy","pre","post"],v=e("./h");n.h=v.h;var m=e("./thunk");n.thunk=m.thunk,n.init=l},{"./h":1,"./htmldomapi":2,"./is":3,"./thunk":7,"./vnode":8}],7:[function(e,t,n){"use strict";function r(e,t){t.elm=e.elm,e.data.fn=t.data.fn,e.data.args=t.data.args,t.data=e.data,t.children=e.children,t.text=e.text,t.elm=e.elm}function o(e){var t=e.data,n=t.fn.apply(void 0,t.args);r(n,e)}function i(e,t){var n,o=e.data,i=t.data,a=o.args,s=i.args;for(o.fn===i.fn&&a.length===s.length||r(i.fn.apply(void 0,s),t),n=0;n<s.length;++n)if(a[n]!==s[n])return void r(i.fn.apply(void 0,s),t);r(e,t)}var a=e("./h");n.thunk=function(e,t,n,r){return void 0===r&&(r=n,n=t,t=void 0),a.h(e,{key:t,hook:{init:o,prepatch:i},fn:n,args:r})},Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.thunk},{"./h":1}],8:[function(e,t,n){"use strict";function r(e,t,n,r,o){var i=void 0===t?void 0:t.key;return{sel:e,data:t,children:n,text:r,elm:o,key:i}}n.vnode=r,Object.defineProperty(n,"__esModule",{value:!0}),n.default=r},{}],9:[function(e,t,n){"use strict";function r(e,t,n){if(t.animation.enabled&&!n)return c(e,t);var r=e(t);return t.dom.redraw(),r}function o(e,t,n){var r=n?p.invertKey(e):e;return{key:r,pos:p.key2pos(r),piece:t}}function i(e,t){return e.role===t.role&&e.color===t.color}function a(e,t){return t.sort(function(t,n){return p.distance(e.pos,t.pos)-p.distance(e.pos,n.pos)})[0]}function s(e,t){var n,r,s,l,u,c,d,f=t.dom.bounds.width/8,v=t.dom.bounds.height/8,m={},h=[],b=[],g=[],y=[],w=e.orientation!==t.orientation,k={},P="white"===t.orientation,x=t.movable.dropped;for(s in e.pieces)k[s]=o(s,e.pieces[s],w);for(s=0;s<p.allKeys.length;s++)l=p.allKeys[s],x&&l===x[1]||(n=t.pieces[l],r=k[l],n?r?i(n,r.piece)||(g.push(r),y.push(o(l,n,!1))):y.push(o(l,n,!1)):r&&g.push(r));return y.forEach(function(e){r=a(e,g.filter(function(t){return i(e.piece,t.piece)})),r&&(u=P?r.pos:e.pos,c=P?e.pos:r.pos,d=[(u[0]-c[0])*f,(c[1]-u[1])*v],m[e.key]=[d,d],h.push(r.key))}),g.forEach(function(e){x&&e.key===x[0]||p.containsX(h,e.key)||t.items&&t.items(e.pos,e.key)||b.push({pos:e.pos,piece:e.piece,opacity:1})}),{anims:m,fadings:b}}function l(e,t){return Math.round(e*t)/t}function u(e){if(e.animation.current&&e.animation.current.start){var t=1-((new Date).getTime()-e.animation.current.start)/e.animation.current.duration;if(t<=0)e.animation.current=void 0,e.dom.redraw();else{var n=void 0,r=f(t);for(n in e.animation.current.plan.anims){var o=e.animation.current.plan.anims[n];o[1]=[l(o[0][0]*r,10),l(o[0][1]*r,10)]}for(n in e.animation.current.plan.fadings)e.animation.current.plan.fadings[n].opacity=l(r,100);e.dom.redraw(),p.raf(function(){return u(e)})}}}function c(e,t){var n={orientation:t.orientation,pieces:{}};for(var r in t.pieces)n.pieces[r]={role:t.pieces[r].role,color:t.pieces[r].color};var o=e(t);if(t.animation.enabled){var i=s(n,t);if(d(i.anims)&&d(i.fadings))t.dom.redraw();else{var a=t.animation.current&&t.animation.current.start;t.animation.current={start:(new Date).getTime(),duration:t.animation.duration,plan:i},a||u(t)}}else t.dom.redraw();return o}function d(e){for(var t in e)return!1;return!0}function f(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1}var p=e("./util");Object.defineProperty(n,"__esModule",{value:!0}),n.default=r},{"./util":23}],10:[function(e,t,n){"use strict";function r(e){return{data:e,getFen:function(){return i.write(e.pieces)},getMaterialDiff:function(){return o.getMaterialDiff(e)},set:function(t){s.default(function(e){return a.default(e,t)},e)},toggleOrientation:function(){s.default(o.toggleOrientation,e)},setPieces:function(t){s.default(function(e){return o.setPieces(e,t)},e)},selectSquare:function(t){s.default(function(e){return o.selectSquare(e,t)},e,!0)},move:function(t,n){s.default(function(e){return o.baseMove(e,t,n)},e)},newPiece:function(t,n){s.default(function(e){return o.baseNewPiece(e,t,n)},e)},playPremove:function(){s.default(o.playPremove,e)},playPredrop:function(t){s.default(function(e){return o.playPredrop(e,t)},e)},cancelPremove:function(){s.default(o.unsetPremove,e,!0)},cancelPredrop:function(){s.default(o.unsetPredrop,e,!0)},cancelMove:function(){s.default(function(e){o.cancelMove(e),l.cancel(e)},e,!0)},stop:function(){s.default(function(e){o.stop(e),l.cancel(e)},e,!0)},explode:function(t){u.default(e,t)},setAutoShapes:function(t){s.default(function(e){return e.drawable.autoShapes=t},e)},setShapes:function(t){s.default(function(e){return e.drawable.shapes=t},e)}}}var o=e("./board"),i=e("./fen"),a=e("./configure"),s=e("./anim"),l=e("./drag"),u=e("./explosion");Object.defineProperty(n,"__esModule",{value:!0}),n.default=r},{"./anim":9,"./board":11,"./configure":12,"./drag":14,"./explosion":17,"./fen":18}],11:[function(e,t,n){"use strict";function r(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e&&setTimeout(function(){return e.apply(void 0,t)},1)}function o(e){e.orientation=S.opposite(e.orientation)}function i(e){e.lastMove=void 0,w(e),u(e),d(e)}function a(e,t){for(var n in t)t[n]?e.pieces[n]=t[n]:delete e.pieces[n];e.movable.dropped=void 0}function s(e,t){if(t===!0&&(t=e.turnColor),t)for(var n in e.pieces)"king"===e.pieces[n].role&&e.pieces[n].color===t&&(e.check=n);else e.check=void 0}function l(e,t,n,o){d(e),e.premovable.current=[t,n],r(e.premovable.events.set,t,n,o)}function u(e){e.premovable.current&&(e.premovable.current=void 0,r(e.premovable.events.unset))}function c(e,t,n){u(e),e.predroppable.current={role:t,key:n},r(e.predroppable.events.set,t,n)}function d(e){var t=e.predroppable;t.current&&(t.current=void 0,r(t.events.unset))}function f(e,t,n){if(e.autoCastle){var r=e.pieces[n];if("king"===r.role){var o=S.key2pos(t);if(5===o[0]&&(1===o[1]||8===o[1])){var i,a,s,l=S.key2pos(n);if(7===l[0]||8===l[0])i=S.pos2key([8,o[1]]),a=S.pos2key([6,o[1]]),s=S.pos2key([7,o[1]]);else{if(3!==l[0]&&1!==l[0])return;i=S.pos2key([1,o[1]]),a=S.pos2key([4,o[1]]),s=S.pos2key([3,o[1]])}delete e.pieces[t],delete e.pieces[n],delete e.pieces[i],e.pieces[s]={role:"king",color:r.color},e.pieces[a]={role:"rook",color:r.color}}}}}function p(e,t,n){if(t===n||!e.pieces[t])return!1;var o=e.pieces[n]&&e.pieces[n].color!==e.pieces[t].color?e.pieces[n]:void 0;return r(e.events.move,t,n,o),e.pieces[n]=e.pieces[t],delete e.pieces[t],e.lastMove=[t,n],e.check=void 0,f(e,t,n),r(e.events.change),e.movable.dropped=void 0,!0}function v(e,t,n,o){if(e.pieces[n]){if(!o)return!1;delete e.pieces[n]}return r(e.events.dropNewPiece,t,n),e.pieces[n]=t,e.lastMove=[n,n],e.check=void 0,r(e.events.change),e.movable.dropped=void 0,e.movable.dests=void 0,e.turnColor=S.opposite(e.turnColor),!0}function m(e,t,n){var r=p(e,t,n);return r&&(e.movable.dests={},e.turnColor=S.opposite(e.turnColor)),r}function h(e,t,n){if(P(e,t,n)){if(m(e,t,n)){var o=A.stop();return w(e),r(e.movable.events.after,t,n,{premove:!1,ctrlKey:e.stats.ctrlKey,holdTime:o}),!0}}else M(e,t,n)?(l(e,t,n,{ctrlKey:e.stats.ctrlKey}),w(e)):k(e,n)||C(e,n)?(y(e,n),A.start()):w(e);return!1}function b(e,t,n,o){if(x(e,t,n)||o){var i=e.pieces[t];delete e.pieces[t],v(e,i,n,o),e.movable.dropped=void 0,r(e.movable.events.afterNewPiece,i.role,n,{predrop:!1})}else O(e,t,n)?c(e,e.pieces[t].role,n):(u(e),d(e));delete e.pieces[t],w(e)}function g(e,t,n){e.selected?e.selected!==t||e.draggable.enabled?(e.selectable.enabled||n)&&e.selected!==t?h(e,e.selected,t)&&(e.stats.dragged=!1):A.start():(w(e),A.cancel()):(k(e,t)||C(e,t))&&(y(e,t),A.start()),t&&r(e.events.select,t)}function y(e,t){e.selected=t,C(e,t)?e.premovable.dests=q.default(e.pieces,t,e.premovable.castle):e.premovable.dests=void 0}function w(e){e.selected=void 0,e.premovable.dests=void 0,A.cancel()}function k(e,t){var n=e.pieces[t];return n&&("both"===e.movable.color||e.movable.color===n.color&&e.turnColor===n.color)}function P(e,t,n){return t!==n&&k(e,t)&&(e.movable.free||!!e.movable.dests&&S.containsX(e.movable.dests[t],n))}function x(e,t,n){var r=e.pieces[t];return r&&n&&(t===n||!e.pieces[n])&&("both"===e.movable.color||e.movable.color===r.color&&e.turnColor===r.color)}function C(e,t){var n=e.pieces[t];return n&&e.premovable.enabled&&e.movable.color===n.color&&e.turnColor!==n.color}function M(e,t,n){return t!==n&&C(e,t)&&S.containsX(q.default(e.pieces,t,e.premovable.castle),n)}function O(e,t,n){var r=e.pieces[t];return r&&n&&(!e.pieces[n]||e.pieces[n].color!==e.movable.color)&&e.predroppable.enabled&&("pawn"!==r.role||"1"!==n[1]&&"8"!==n[1])&&e.movable.color===r.color&&e.turnColor!==r.color}function T(e,t){var n=e.pieces[t];return n&&e.draggable.enabled&&("both"===e.movable.color||e.movable.color===n.color&&(e.turnColor===n.color||e.premovable.enabled))}function N(e){var t=e.premovable.current;if(!t)return!1;var n=t[0],o=t[1],i=!1;return P(e,n,o)&&m(e,n,o)&&(r(e.movable.events.after,n,o,{premove:!0}),i=!0),u(e),i}function _(e,t){var n=e.predroppable.current,o=!1;if(!n)return!1;if(t(n)){var i={role:n.role,color:e.movable.color};v(e,i,n.key)&&(r(e.movable.events.afterNewPiece,n.role,n.key,{predrop:!0}),o=!0)}return d(e),o}function D(e){u(e),d(e),w(e)}function K(e){e.movable.color=void 0,e.movable.dests=void 0,D(e)}function E(e,t){var n=Math.ceil(8*((t[0]-e.dom.bounds.left)/e.dom.bounds.width));n="white"===e.orientation?n:9-n;var r=Math.ceil(8-8*((t[1]-e.dom.bounds.top)/e.dom.bounds.height));return r="white"===e.orientation?r:9-r,n>0&&n<9&&r>0&&r<9?S.pos2key([n,r]):void 0}function j(e){var t,n,r,o={king:0,queen:0,rook:0,bishop:0,knight:0,pawn:0};for(var i in e.pieces)t=e.pieces[i],o[t.role]+="white"===t.color?1:-1;var a={white:{},black:{}};for(n in o)r=o[n],r>0?a.white[n]=r:r<0&&(a.black[n]=-r);return a}function B(e){var t=0;for(var n in e.pieces)t+=L[e.pieces[n].role]*("white"===e.pieces[n].color?1:-1);return t}var S=e("./util"),q=e("./premove"),A=e("./hold");n.toggleOrientation=o,n.reset=i,n.setPieces=a,n.setCheck=s,n.unsetPremove=u,n.unsetPredrop=d,n.baseMove=p,n.baseNewPiece=v,n.userMove=h,n.dropNewPiece=b,n.selectSquare=g,n.setSelected=y,n.unselect=w,n.isDraggable=T,n.playPremove=N,n.playPredrop=_,n.cancelMove=D,n.stop=K,n.getKeyAtDomPos=E,n.getMaterialDiff=j;var L={pawn:1,knight:3,bishop:3,rook:5,queen:9,king:0};n.getScore=B},{"./hold":19,"./premove":22,"./util":23}],12:[function(e,t,n){"use strict";function r(e,t){t.movable&&t.movable.dests&&(e.movable.dests=void 0);var n=t.check;if(delete t.check,o(e,t),t.fen&&(e.pieces=s.read(t.fen),e.drawable.shapes=[]),void 0!==n&&a.setCheck(e,n),e.movable.dropped=void 0,e.selected&&a.setSelected(e,e.selected),(!e.animation.duration||e.animation.duration<40)&&(e.animation.enabled=!1),!e.movable.rookCastle&&e.movable.dests){var r="white"===e.movable.color?1:8,i="e"+r,l=e.movable.dests[i];if(!l||"king"!==e.pieces[i].role)return;e.movable.dests[i]=l.filter(function(e){return(e!=="a"+r||l.indexOf("c"+r)===-1)&&(e!=="h"+r||l.indexOf("g"+r)===-1)})}}function o(e,t){for(var n in t)i(e[n])&&i(t[n])?o(e[n],t[n]):e[n]=t[n]}function i(e){return"object"==typeof e}var a=e("./board"),s=e("./fen");Object.defineProperty(n,"__esModule",{value:!0}),n.default=r},{"./board":11,"./fen":18}],13:[function(e,t,n){"use strict";function r(){return{pieces:o.read(o.initial),orientation:"white",turnColor:"white",coordinates:!0,autoCastle:!1,viewOnly:!1,disableContextMenu:!1,resizable:!0,pieceKey:!1,highlight:{lastMove:!0,check:!0,dragOver:!0},animation:{enabled:!0,duration:200},movable:{free:!0,color:"both",dropOff:"revert",showDests:!0,events:{},rookCastle:!0},premovable:{enabled:!0,showDests:!0,castle:!0,events:{}},predroppable:{enabled:!1,events:{}},draggable:{enabled:!0,distance:3,autoDistance:!0,centerPiece:!0,showGhost:!0},selectable:{enabled:!0},stats:{dragged:!("ontouchstart"in window)},events:{},drawable:{enabled:!1,eraseOnClick:!0,shapes:[],autoShapes:[],brushes:{green:{key:"g",color:"#15781B",opacity:1,lineWidth:10},red:{key:"r",color:"#882020",opacity:1,lineWidth:10},blue:{key:"b",color:"#003088",opacity:1,lineWidth:10},yellow:{key:"y",color:"#e68f00",opacity:1,lineWidth:10},paleBlue:{key:"pb",color:"#003088",opacity:.4,lineWidth:15},paleGreen:{key:"pg",color:"#15781B",opacity:.4,lineWidth:15},paleRed:{key:"pr",color:"#882020",opacity:.4,lineWidth:15},paleGrey:{key:"pgr",color:"#4a4a4a",opacity:.35,lineWidth:15}},pieces:{baseUrl:"https://lichess1.org/assets/piece/cburnett/"}},editable:{enabled:!1,selected:"pointer"}}}var o=e("./fen");Object.defineProperty(n,"__esModule",{value:!0}),n.default=r},{"./fen":18}],14:[function(e,t,n){"use strict";function r(e){return e?e.color+e.role:""}function o(e,t){var n=f.key2pos(t),r=e.dom.bounds;return"white"!==e.orientation&&(n[0]=9-n[0],n[1]=9-n[1]),{left:r.left+r.width*(n[0]-1)/8,top:r.top+r.height*(8-n[1])/8,width:r.width/8,height:r.height/8}}function i(e,t){if(!(void 0!==t.button&&0!==t.button||t.touches&&t.touches.length>1)){t.stopPropagation(),t.preventDefault(),c=t.target;var n=e.selected,i=f.eventPosition(t),s=d.getKeyAtDomPos(e,i);if(s){var l=e.pieces[s];if(n||!e.drawable.eraseOnClick&&l&&l.color===e.turnColor||p.clear(e),!e.viewOnly){var u=!!e.premovable.current,v=!!e.predroppable.current;e.stats.ctrlKey=t.ctrlKey,d.selectSquare(e,s);var m=e.selected===s;if(l&&m&&d.isDraggable(e,s)){var h=o(e,s);e.draggable.current={previouslySelected:n,orig:s,pieceHash:r(l),rel:i,epos:i,pos:[0,0],dec:e.draggable.centerPiece?[i[0]-(h.left+h.width/2),i[1]-(h.top+h.height/2)]:[0,0],started:e.draggable.autoDistance&&e.stats.dragged}}else u&&d.unsetPremove(e),v&&d.unsetPredrop(e);a(e)}}}}function a(e){f.raf(function(){var t=e.draggable.current;t&&(e.animation.current&&e.animation.current.plan.anims[t.orig]&&(e.animation.current=void 0),r(e.pieces[t.orig])!==t.pieceHash?u(e):(!t.started&&f.distance(t.epos,t.rel)>=e.draggable.distance&&(t.started=!0),t.started&&(t.pos=[t.epos[0]-t.rel[0],t.epos[1]-t.rel[1]],t.over=d.getKeyAtDomPos(e,t.epos)))),e.dom.redraw(),t&&a(e)})}function s(e,t){t.touches&&t.touches.length>1||e.draggable.current&&(e.draggable.current.epos=f.eventPosition(t))}function l(e,t){var n=e.draggable.current;if(n||e.editable.enabled&&"pointer"!==e.editable.selected){if("touchend"===t.type&&c!==t.target&&n&&!n.newPiece)return void(e.draggable.current=void 0);d.unsetPremove(e),d.unsetPredrop(e);var r=f.eventPosition(t),o=d.getKeyAtDomPos(e,r);if(o)if(e.editable.enabled&&"pointer"!==e.editable.selected)if("trash"===e.editable.selected)delete e.pieces[o],e.dom.redraw();else{var i="a0";e.pieces[i]=e.editable.selected,d.dropNewPiece(e,i,o,!0)}else n&&n.started&&(n.newPiece?d.dropNewPiece(e,n.orig,o):(n.orig!==o&&(e.movable.dropped=[n.orig,o]),e.stats.ctrlKey=t.ctrlKey,d.userMove(e,n.orig,o)&&(e.stats.dragged=!0)));!n||n.orig!==n.previouslySelected||n.orig!==o&&o?e.selectable.enabled||d.unselect(e):d.unselect(e),e.draggable.current=void 0}}function u(e){e.draggable.current&&(e.draggable.current=void 0,d.unselect(e))}var c,d=e("./board"),f=e("./util"),p=e("./draw");n.start=i,n.move=s,n.end=l,n.cancel=u},{"./board":11,"./draw":15,"./util":23}],15:[function(e,t,n){"use strict";function r(e){var t=e.shiftKey&&m.isRightButton(e)?1:0,n=e.altKey?2:0;return h[t+n]}function o(e,t){if(!(t.touches&&t.touches.length>1)){t.stopPropagation(),t.preventDefault(),v.cancelMove(e);var n=m.eventPosition(t),o=v.getKeyAtDomPos(e,n);o&&(e.drawable.current={orig:o,dest:void 0,pos:n,brush:r(t)},i(e))}}function i(e){m.raf(function(){var t=e.drawable.current;if(t){var n=v.getKeyAtDomPos(e,t.pos);t.orig===n?t.dest=void 0:t.dest=n}e.dom.redraw(),t&&i(e)})}function a(e,t){e.drawable.current&&(e.drawable.current.pos=m.eventPosition(t))}function s(e){var t=e.drawable.current;t&&(t.dest?f(e.drawable,t,t.dest):d(e.drawable,t),e.drawable.current=void 0,e.dom.redraw())}function l(e){e.drawable.current&&(e.drawable.current=void 0)}function u(e){e.drawable.shapes.length&&(e.drawable.shapes=[],e.dom.redraw(),p(e.drawable))}function c(e){return function(t){return!e(t)}}function d(e,t){var n=t.orig,r=function(e){return e.orig===n&&!e.dest},o=e.shapes.filter(r)[0];o&&(e.shapes=e.shapes.filter(c(r))),o&&o.brush===t.brush||e.shapes.push({brush:t.brush,orig:n}),p(e)}function f(e,t,n){var r=t.orig,o=function(e){return!!e.dest&&(e.orig===r&&e.dest===n||e.dest===r&&e.orig===n)},i=e.shapes.filter(o).length>0;i?e.shapes=e.shapes.filter(c(o)):e.shapes.push({brush:t.brush,orig:r,dest:n}),p(e)}function p(e){e.onChange&&e.onChange(e.shapes)}var v=e("./board"),m=e("./util"),h=["green","red","blue","yellow"];n.start=o,n.processDraw=i,n.move=a,n.end=s,n.cancel=l,n.clear=u},{"./board":11,"./util":23}],16:[function(e,t,n){"use strict";function r(e){var t,n,r,p=o(e),v=i(e,s.move,l.move),m=i(e,s.end,l.end);e.editable.enabled?(t=function(t){"pointer"===e.editable.selected?"mousemove"!==t.type&&p(t):("mousemove"!==t.type||u.isLeftButton(t))&&m(t)},n=function(t){"pointer"===e.editable.selected&&v(t)},r=function(t){"pointer"===e.editable.selected&&m(t)},c.push("mousemove")):(t=p,n=v,r=m),c.forEach(function(n){return e.dom.element.addEventListener(n,t)}),d.forEach(function(e){return document.addEventListener(e,n)}),f.forEach(function(e){return document.addEventListener(e,r)}),a(e);var h=function(t){return!e.disableContextMenu&&!e.drawable.enabled||(t.preventDefault(),!1)};e.dom.element.addEventListener("contextmenu",h)}function o(e){return function(t){u.isRightButton(t)&&e.draggable.current?(e.draggable.current.newPiece&&delete e.pieces[e.draggable.current.orig],e.draggable.current=void 0,e.selected=void 0):(t.shiftKey||u.isRightButton(t))&&e.drawable.enabled?l.start(e,t):s.start(e,t)}}function i(e,t,n){return function(r){(r.shiftKey||u.isRightButton(r))&&e.drawable.enabled?n(e,r):e.viewOnly||t(e,r)}}function a(e){function t(){e.dom.bounds=e.dom.element.getBoundingClientRect(),e.dom.redraw()}e.resizable&&(["onscroll","onresize"].forEach(function(e){var n=window[e];window[e]=function(){n&&n(),t()}}),document.body.addEventListener("chessground.resize",t,!1))}var s=e("./drag"),l=e("./draw"),u=e("./util"),c=["touchstart","mousedown"],d=["touchmove","mousemove"],f=["touchend","mouseup"];Object.defineProperty(n,"__esModule",{value:!0}),n.default=r},{"./drag":14,"./draw":15,"./util":23}],17:[function(e,t,n){"use strict";function r(e,t){e.exploding={stage:1,keys:t},e.dom.redraw(),setTimeout(function(){o(e,2),setTimeout(function(){return o(e,void 0)},120)},120)}function o(e,t){e.exploding&&(t?e.exploding.stage=t:e.exploding=void 0,e.dom.redraw())}Object.defineProperty(n,"__esModule",{value:!0}),n.default=r},{}],18:[function(e,t,n){"use strict";function r(e){"start"===e&&(e=n.initial);var t,r,o,s={};return e.replace(/ .+$/,"").replace(/~/g,"").split("/").forEach(function(e,n){t=0,e.split("").forEach(function(e){r=parseInt(e),r?t+=r:(++t,o=e.toLowerCase(),s[i.pos2key([t,8-n])]={role:a[o],color:e===o?"black":"white"})})}),s}function o(e){var t,n;return[8,7,6,5,4,3,2].reduce(function(e,t){return e.replace(new RegExp(Array(t+1).join("1"),"g"),t)},i.invRanks.map(function(r){return i.ranks.map(function(o){return t=e[i.pos2key([o,r])],t?(n=s[t.role],"white"===t.color?n.toUpperCase():n):"1"}).join("")}).join("/"))}var i=e("./util");n.initial="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR";var a={p:"pawn",r:"rook",n:"knight",b:"bishop",q:"queen",k:"king"},s={pawn:"p",rook:"r",knight:"n",bishop:"b",queen:"q",king:"k"};n.read=r,n.write=o},{"./util":23}],19:[function(e,t,n){"use strict";function r(){a=new Date}function o(){a=void 0}function i(){if(!a)return 0;var e=(new Date).getTime()-a.getTime();return a=void 0,e}var a;n.start=r,n.cancel=o,n.stop=i},{}],20:[function(e,t,n){t.exports=e("./main").default},{"./main":21}],21:[function(e,t,n){"use strict";function r(e,t){function n(){c=f(c,a.default(d.data))}var r=document.createElement("div");e.appendChild(r);var o=l.default();s.default(o,t),o.dom={element:r,bounds:e.getBoundingClientRect(),redraw:function(){}};var c,d=i.default(o);return c=f(r,a.default(d.data)),o.dom.element=c.elm,o.dom.redraw=n,u.default(o),d}var o=e("snabbdom"),i=e("./api"),a=e("./view"),s=e("./configure"),l=e("./defaults"),u=e("./events"),c=e("snabbdom/modules/class"),d=e("snabbdom/modules/style"),f=o.init([c.default,d.default]);Object.defineProperty(n,"__esModule",{value:!0}),n.default=r},{"./api":10,"./configure":12,"./defaults":13,"./events":16,"./view":24,snabbdom:6,"snabbdom/modules/class":4,"snabbdom/modules/style":5}],22:[function(e,t,n){"use strict";function r(e,t){return Math.abs(e-t)}function o(e){return function(t,n,o,i){return r(t,n)<2&&("white"===e?i===o+1||o<=2&&i===o+2&&t===n:i===o-1||o>=7&&i===o-2&&t===n)}}function i(e,t,n){return function(o,i,a,s){return r(o,i)<2&&r(a,s)<2||n&&a===s&&a===("white"===e?1:8)&&(5===o&&(3===i||7===i)||l.containsX(t,i))}}function a(e,t){var n;return Object.keys(e).filter(function(r){return n=e[r],n&&n.color===t&&"rook"===n.role}).map(function(e){return l.key2pos(e)[0]})}function s(e,t,n){var r,s=e[t],p=l.key2pos(t);switch(s.role){case"pawn":r=o(s.color);break;case"knight":r=u;break;case"bishop":r=c;break;case"rook":r=d;break;case"queen":r=f;break;case"king":r=i(s.color,a(e,s.color),n)}return l.allPos.filter(function(e){return(p[0]!==e[0]||p[1]!==e[1])&&r(p[0],p[1],e[0],e[1])}).map(l.pos2key)}var l=e("./util"),u=function(e,t,n,o){var i=r(e,t),a=r(n,o);return 1===i&&2===a||2===i&&1===a},c=function(e,t,n,o){return r(e,t)===r(n,o)},d=function(e,t,n,r){return e===t||n===r},f=function(e,t,n,r){return c(e,n,t,r)||d(e,n,t,r)};Object.defineProperty(n,"__esModule",{value:!0}),n.default=s},{"./util":23}],23:[function(e,t,n){"use strict";function r(e){return n.files[e[0]-1]+e[1]}function o(e){return[n.fileNumbers[e[0]],parseInt(e[1])]}function i(e){return n.files[8-n.fileNumbers[e[0]]]+(9-parseInt(e[1]))}function a(e){return"white"===e?"black":"white"}function s(e,t){return e&&e.indexOf(t)!==-1}function l(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))}function u(){return"transform"in document.body.style?"transform":"webkitTransform"in document.body.style?"webkitTransform":"mozTransform"in document.body.style?"mozTransform":"oTransform"in document.body.style?"oTransform":"msTransform"}function c(){return y||(y=u()),y}function d(){return void 0===w&&(w=window.navigator.userAgent.indexOf("Trident/")>-1),w}function f(e){return"translate("+e[0]+"px,"+e[1]+"px)"}function p(e){if(e.clientX||0===e.clientX)return[e.clientX,e.clientY];if(e.touches&&e.targetTouches[0])return[e.targetTouches[0].clientX,e.targetTouches[0].clientY];throw"Cannot find position of event "+e}function v(e){return 1===e.buttons||1===e.button}function m(e){return 2===e.buttons||2===e.button}n.files=["a","b","c","d","e","f","g","h"],n.ranks=[1,2,3,4,5,6,7,8],n.invRanks=[8,7,6,5,4,3,2,1],n.fileNumbers={a:1,b:2,c:3,d:4,e:5,f:6,g:7,h:8},n.pos2key=r,n.key2pos=o,n.invertKey=i,n.allPos=[],n.allKeys=[];for(var h=8;h>0;--h)for(var b=1;b<9;++b){var g=[b,h];n.allPos.push(g),n.allKeys.push(r(g))}n.invKeys=n.allKeys.slice(0).reverse(),n.opposite=a,n.containsX=s,n.distance=l;var y;n.transformProp=c;var w;n.isTrident=d,n.translate=f,n.eventPosition=p,n.isLeftButton=v,n.isRightButton=m,n.raf=(window.requestAnimationFrame||window.setTimeout).bind(window)},{}],24:[function(e,t,n){"use strict";function r(e){return t={},t[e.role]=!0,t[e.color]=!0,t;var t}function o(e,t,n){var o=r(e.pieces[t]),i=a(v.key2pos(t),n),s=e.draggable.current,l=e.animation.current;if(s&&s.orig===t&&s.started)i[0]+=s.pos[0]+s.dec[0],i[1]+=s.pos[1]+s.dec[1],o.dragging=!0;else if(l){var u=l.plan.anims[t];u&&(i[0]+=u[1][0],i[1]+=u[1][1])}return p.h(m,{key:"p"+t,class:r(e.pieces[t]),style:(c={},c[n.transformProp]=v.translate(i),c)});var c}function i(e,t,n){return p.h(h,{key:"s"+e,class:t,style:(r={},r[n.transformProp]=v.translate(a(v.key2pos(e),n)),r)});var r}function a(e,t){return[(t.asWhite?e[0]-1:8-e[0])*t.bounds.width/8,(t.asWhite?8-e[1]:e[1]-1)*t.bounds.height/8]}function s(e,t,n){var o=r(t);return o.ghost=!0,p.h(m,{key:"g"+e,classes:o,style:(i={},i[n.transformProp]=v.translate(a(v.key2pos(e),n)),i)});var i}function l(e,t){var n=r(e.piece);return n.fading=!0,p.h(m,{key:"f"+v.pos2key(e.pos),classes:n,style:(o={},o[t.transformProp]=v.translate(a(e.pos,t)),o.opacity=e.opacity,o)});var o}function u(e,t,n){e[t]?e[t][n]=!0:e[t]=(r={},r[n]=!0,r);var r}function c(e,t){var n,r,o={};if(e.lastMove&&e.highlight.lastMove)for(n in e.lastMove)u(o,e.lastMove[n],"last-move");if(e.check&&e.highlight.check&&u(o,e.check,"check"),e.selected){u(o,e.selected,"selected");var a=e.draggable.current&&e.draggable.current.over,s=e.movable.dests&&e.movable.dests[e.selected];if(s)for(n in s)r=s[n],e.movable.showDests&&u(o,r,"move-dest"),r===a?u(o,r,"drag-over"):e.movable.showDests&&e.pieces[r]&&u(o,r,"oc");
var l=e.premovable.dests;if(l)for(n in l)r=l[n],e.movable.showDests&&u(o,r,"premove-dest"),r===a?u(o,r,"drag-over"):e.movable.showDests&&e.pieces[r]&&u(o,r,"oc")}var c=e.premovable.current;if(c)for(n in c)u(o,c[n],"current-premove");else e.predroppable.current&&u(o,e.predroppable.current.key,"current-premove");var d=e.exploding;if(d)for(n in d.keys)u(o,d.keys[n],"exploding"+d.stage);var f=[];if(e.items)return f;for(n in o)f.push(i(n,o[n],t));return f}function d(e){var t,n={asWhite:"white"===e.orientation,bounds:e.dom.bounds,transformProp:v.transformProp()},r=e.animation.current,i=c(e,n),a=r&&r.plan.fadings,u=e.draggable.current;if(a)for(t in a)i.push(l(a[t],n));var d=n.asWhite?v.allKeys:v.invKeys;if(e.items);else{for(t=0;t<64;t++)e.pieces[d[t]]&&i.push(o(e,d[t],n));u&&u.newPiece&&i.push(o(e,"a0",n))}return u&&e.draggable.showGhost&&!u.newPiece&&i.push(s(u.orig,e.pieces[u.orig],n)),i}function f(e){return p.h("div",{class:(t={"cg-board-wrap":!0},t["orientation-"+e.orientation]=!0,t["view-only"]=e.viewOnly,t.manipulable=!e.viewOnly,t)},[p.h("div",{class:{"cg-board":!0}},d(e))]);var t}var p=e("snabbdom"),v=e("./util"),m="piece",h="square";Object.defineProperty(n,"__esModule",{value:!0}),n.default=f},{"./util":23,snabbdom:6}]},{},[20])(20)});