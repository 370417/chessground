!function e(t,n,r){function i(a,s){if(!n[a]){if(!t[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[a]={exports:{}};t[a][0].call(l.exports,function(e){var n=t[a][1][e];return i(n?n:e)},l,l.exports,e,t,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t){function n(e,t){var n=new r(t);return m.module(e,{controller:function(){return n},view:i}),o(e,n,i)}var r=e("./ctrl"),i=e("./view"),o=e("./api");window.chessground=t.exports=n},{"./api":3,"./ctrl":6,"./view":13}],2:[function(e,t){function n(e,t,n){var r=n?u.invertKey(e):e;return{key:r,pos:u.key2pos(r),role:t.role,color:t.color}}function r(e,t){return e.role===t.role&&e.color===t.color}function i(e,t){return Math.sqrt(Math.pow(e.pos[0]-t.pos[0],2)+Math.pow(e.pos[1]-t.pos[1],2))}function o(e,t){return t.sort(function(t,n){return i(e,t)-i(e,n)})[0]}function a(e,t){var i=t.size/8,a={},s=[],c=[],l=e.orientation!==t.orientation,h={};return u.allKeys.forEach(function(t){if(e.pieces[t]){var r=n(t,e.pieces[t],l);h[r.key]=r}}),u.allKeys.forEach(function(e){if(e!==t.movable.dropped){var i=t.pieces.get(e),o=h[e];i?o?r(i,o)||(s.push(o),c.push(n(e,i,!1))):c.push(n(e,i,!1)):o&&s.push(o)}}),c.forEach(function(e){var n=o(e,s.filter(r.bind(null,e)));if(n){var c="white"===t.orientation?n.pos:e.pos,u="white"===t.orientation?e.pos:n.pos,l=[(c[0]-u[0])*i,(u[1]-c[1])*i];a[e.key]=[l,l]}}),a}function s(){var e=this,t=1-((new Date).getTime()-e.current.start)/e.current.duration;0>=t?(e.current={},m.redraw()):(m.startComputation(),_.forIn(e.current.anims,function(n,r){e.current.anims[r][1]=[n[0][0]*t,n[0][1]*t]}),m.endComputation(),requestAnimationFrame(s.bind(e)))}function c(e,t){var n={orientation:e.orientation,pieces:_.clone(e.pieces.all,!0)},r=t(),i=a(n,e);return Object.getOwnPropertyNames(i).length>0&&(e.animation.current={start:(new Date).getTime(),duration:e.animation.duration,anims:i},s.call(e.animation)),r}var u=e("./util");t.exports=function(e,t){return function(){return e.animation.enabled&&!e.animation.current.start&&e.size?c(e,t.apply.bind(t,e,arguments)):t.apply(e,arguments)}}},{"./util":12}],3:[function(e,t){var n=e("./fen");t.exports=function(e,t,r){var i=function(n){return function(){var i=n.apply(null,arguments);return m.render(e,r(t)),i}};return{set:i(t.reconfigure),toggleOrientation:i(t.toggleOrientation),getOrientation:function(){return t.board.orientation},getPieces:function(){return t.board.pieces.all},getFen:function(){return n.write(t.board.pieces.all)},dump:function(){return t.board},move:i(t.apiMove),setPieces:i(t.setPieces),playPremove:i(t.playPremove)}}},{"./fen":9}],4:[function(e,t){function n(e){setTimeout(e(),20)}function r(){this.orientation="white"===this.orientation?"black":"white"}function i(e){this.pieces.set(e),this.movable.dropped=null}function o(e,t){var r=m(this,function(){var r=this.pieces.move(e,t);return r&&(this.lastMove=[e,t],this.check=null,n(this.events.change)),r})();return r&&(this.movable.dropped=null),r}function a(e,t){return o.call(this,e,t)}function s(e,t){t?h.call(this,e,t)?o.call(this,e,t)&&(u.call(this,null),n(this.movable.events.after.bind(null,e,t))):f.call(this,e,t)?(this.premovable.current=[e,t],u.call(this,null)):l.call(this,t)||p.call(this,t)?u.call(this,t):u.call(this,null):(u.call(this,null),"trash"===this.movable.dropOff&&(this.pieces.remove(e),n(this.events.change)))}function c(e){this.selected?this.selected!==e&&s.call(this,this.selected,e):(l.call(this,e)||p.call(this,e))&&u.call(this,e)}function u(e){this.selected=e,this.premovable.dests=e&&p.call(this,e)?g(this.pieces,e):null}function l(e){var t=this.pieces.get(e);return t&&("both"===this.movable.color||this.movable.color===t.color&&this.turnColor===t.color)}function h(e,t){return e!==t&&l.call(this,e)&&(this.movable.free||b.containX(this.movable.dests[e],t))}function p(e){var t=this.pieces.get(e);return t&&this.premovable.enabled&&this.movable.color===t.color&&this.turnColor!==t.color}function f(e,t){return e!==t&&p.call(this,e)&&_util.containX(g(this.pieces,e),t)}function d(e){var t=this.pieces.get(e);return t&&this.draggable.enabled&&("both"===this.movable.color||this.movable.color===t.color&&(this.turnColor===t.color||this.premovable.enabled))}function v(){var e=this.premovable.current;if(e){var t=e[0],r=e[1];h.call(this,t,r)&&o.call(this,t,r)&&n(this.movable.events.after.bind(null,t,r)),this.premovable.current=null}}var b=e("./util"),g=e("./premove"),m=e("./anim");t.exports={toggleOrientation:r,setPieces:i,selectSquare:c,setSelected:u,isDraggable:d,canMove:h,userMove:s,apiMove:a,playPremove:v}},{"./anim":2,"./premove":11,"./util":12}],5:[function(e,t){var n=e("./fen"),r=e("./pieces");t.exports=function(e){_.merge(this,e),this.fen&&(this.pieces=new r.Pieces(n.read(this.fen)),delete this.fen),this.movable.dropped=null}},{"./fen":9,"./pieces":10}],6:[function(e,t){var n=e("./board"),r=e("./data"),i=e("./configure"),o=e("./anim");t.exports=function(e){this.board=r(e),this.reconfigure=o(this.board,i),this.toggleOrientation=o(this.board,n.toggleOrientation),this.setPieces=o(this.board,n.setPieces),this.selectSquare=n.selectSquare.bind(this.board),this.apiMove=n.apiMove.bind(this.board),this.playPremove=n.playPremove.bind(this.board)}},{"./anim":2,"./board":4,"./configure":5,"./data":7}],7:[function(e,t){var n=e("./pieces"),r=e("./fen"),i=e("./configure");t.exports=function(e){var t={pieces:new n.Pieces(r.read(r.initial)),orientation:"white",turnColor:"white",check:null,lastMove:null,selected:null,size:null,animation:{enabled:!0,duration:200,current:{}},movable:{free:!0,color:"both",dests:{},dropOff:"revert",dropped:null,events:{after:function(){}}},premovable:{enabled:!0,dests:[],current:null},draggable:{enabled:!0,current:{}},events:{change:function(){}}};return i.call(t,e||{}),t}},{"./configure":5,"./fen":9,"./pieces":10}],8:[function(e,t){function n(e){this.draggable.current.pos=[e.pageX-this.draggable.current.rel[0],e.pageY-this.draggable.current.rel[1]],this.draggable.current.over=r(this.orientation,this.draggable.current.bounds,e),m.redraw()}function r(e,t,n){var r=Math.ceil(8*((n.pageX-t.left)/t.width));r="white"===e?r:9-r;var i=Math.ceil(8-8*((n.pageY-t.top)/t.height));return i="white"===e?i:9-i,r>0&&9>r&&i>0&&9>i?a.pos2key([r,i]):void 0}function i(){document.removeEventListener("mousemove",this.draggable.current.move),document.removeEventListener("mouseup",this.draggable.current.end);var e=this.draggable.current.orig,t=this.draggable.current.over;e!==t&&(this.movable.dropped=t),o.userMove.call(this,e,t),this.draggable.current={},m.redraw()}var o=e("./board"),a=e("./util");t.exports=function(e){if(e.stopPropagation(),e.preventDefault(),0===e.button){var t=e.target.parentNode,a=t.parentNode.getBoundingClientRect(),s=r(this.orientation,a,e),c=this.pieces.get(s);c&&o.isDraggable.call(this,s)&&(this.draggable.current={orig:s,bounds:a,rel:[e.pageX,e.pageY],pos:[0,0],over:s,move:n.bind(this),end:i.bind(this)},o.setSelected.call(this,s),document.addEventListener("mousemove",this.draggable.current.move),document.addEventListener("mouseup",this.draggable.current.end))}}},{"./board":4,"./util":12}],9:[function(e,t){function n(e){"start"===e&&(e=o);var t={};return e.replace(/ .+$/,"").split("/").forEach(function(e,n){var r=0;e.split("").forEach(function(e){var o=parseInt(e);o?r+=o:(r++,t[i.pos2key([r,8-n])]={role:a[e.toLowerCase()],color:e===e.toLowerCase()?"black":"white"})})}),t}function r(e){return _.range(8,1,-1).reduce(function(e,t){return e.replace(new RegExp(Array(t+1).join("1"),"g"),t)},_.range(8,0,-1).map(function(t){return _.range(1,9).map(function(n){var r=e[i.pos2key([n,t])];if(r){var o=s[r.role];return"white"===r.color?o.toUpperCase():o}return"1"}).join("")}).join("/"))}var i=e("./util"),o="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR",a={p:"pawn",r:"rook",n:"knight",b:"bishop",q:"queen",k:"king"},s={pawn:"p",rook:"r",knight:"n",bishop:"b",queen:"q",king:"k"};t.exports={initial:o,read:n,write:r}},{"./util":12}],10:[function(e,t){Pieces=function(e){this.all=e,this.get=function(t){return e[t]},this.remove=function(t){delete e[t]},this.put=function(t,n){e[t]=n},this.move=function(e,t){return e!==t&&this.get(e)?(this.put(t,this.get(e)),this.remove(e),!0):!1},this.set=function(e){_.forIn(e,function(e,t){e?this.put(t,e):this.remove(t)}.bind(this))}},t.exports={Pieces:Pieces}},{}],11:[function(e,t){function n(e,t){return Math.abs(e-t)}function r(e,t,r,i,o){return n(t,i)<2&&("white"===e?o===r+1||2===r&&4===o&&t===i:o===r-1||7===r&&5===o&&t===i)}function i(e,t,r,i){var o=n(e,r),a=n(t,i);return 1===o&&2===a||2===o&&1===a}function o(e,t,r,i){return n(e,r)===n(t,i)}function a(e,t,n,r){return e===n||t===r}function s(e,t,n,r){return o(e,t,n,r)||a(e,t,n,r)}function c(e,t,r,i,o,a){return n(r,o)<2&&n(i,a)<2||i===a&&i===("white"===e?1:8)&&(5===r&&(3===o||7===o)||h.containsX(t,o))}function u(e,t){return Object.keys(e).filter(function(n){var r=e[n];return r&&r.color===t&&"rook"===r.role}).map(function(e){return h.key2pos(e)[0]})}function l(e,t){var n,l=e.get(t),p=h.key2pos(t);switch(l.role){case"pawn":n=r.bind(null,l.color);break;case"knight":n=i;break;case"bishop":n=o;break;case"rook":n=a;break;case"queen":n=s;break;case"king":n=c.bind(null,l.color,u(e,l.color))}return h.allPos.filter(function(e){return(p[0]!==e[0]||p[1]!==e[1])&&n(p[0],p[1],e[0],e[1])}).map(h.pos2key)}var h=e("./util");t.exports=l},{"./util":12}],12:[function(e,t){function n(e){return h[e[0]-1]+e[1]}function r(e){return[h.indexOf(e[0])+1,parseInt(e[1])]}function i(e){return h[7-h.indexOf(e[0])]+(9-parseInt(e[1]))}function o(e){return Object.keys(e).filter(function(t){return e[t]}).join(" ")}function a(e){return"white"===e?"black":"white"}function s(e){return"translate3d("+e[0]+"px,"+e[1]+"px,0)"}function c(e,t){return e&&(e[0]===t||e[1]===t)}function u(e,t){return e&&-1!==e.indexOf(t)}function l(e){return console.log(e),e}var h="abcdefgh".split(""),p=_.range(1,9),f=function(){var e=[];return p.forEach(function(t){p.forEach(function(n){e.push([n,t])})}),e}(),d=f.map(n);t.exports={files:h,ranks:p,allPos:f,allKeys:d,pos2key:n,key2pos:r,invertKey:i,classSet:o,opposite:a,translate:s,contains2:c,containsX:u,pp:l}},{}],13:[function(e,t){function n(e,t,n){var r={"class":["cg-piece",n.role,n.color].join(" ")};if(e.board.draggable.current.orig===t)r.style={webkitTransform:i.translate(e.board.draggable.current.pos)},r.class=r.class+" dragging";else if(e.board.animation.current.anims){var o=e.board.animation.current.anims[t];o&&(r.style={webkitTransform:i.translate(o[1])})}return{tag:"div",attrs:r}}function r(e,t){var r=12.5*(t[0]-1)+"%",o=12.5*(t[1]-1)+"%",a=i.files[t[0]-1],s=t[1],c=a+s,u=e.board.pieces.get(c),l={"class":i.classSet({selected:e.board.selected===c,check:e.board.check===c,"last-move":i.contains2(e.board.lastMove,c),"move-dest":i.containsX(e.board.movable.dests[e.board.selected],c),"premove-dest":i.containsX(e.board.premovable.dests,c),"current-premove":i.contains2(e.board.premovable.current,c),"drag-over":e.board.draggable.current.over===c}),style:"white"===e.board.orientation?{left:r,bottom:o}:{right:r,top:o}};return t[1]===("white"===e.board.orientation?1:8)&&(l["data-coord-x"]=a),t[0]===("white"===e.board.orientation?8:1)&&(l["data-coord-y"]=s),{tag:"div",attrs:l,children:u?n(e,c,u):null}}{var i=e("./util"),o=(e("./board"),e("./drag"));e("./anim")}t.exports=function(e){return{tag:"div",attrs:{"class":"cg-board",config:function(t,n){n&&requestAnimationFrame(function(){e.board.size=t.clientWidth})},onclick:function(t){var n=t.target.getAttribute("data-key")||t.target.parentNode.getAttribute("data-key");e.selectSquare(n)},onmousedown:o.bind(e.board)},children:i.allPos.map(function(t){return r(e,t)})}}},{"./anim":2,"./board":4,"./drag":8,"./util":12}]},{},[1]);